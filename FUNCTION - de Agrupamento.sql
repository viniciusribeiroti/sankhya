CREATE OR REPLACE FUNCTION FC_DASH_AGRUP_SOL

(
  P_CODPROJ IN NUMBER
, P_CODTIPOPER IN NUMBER
, P_CODCENCUS IN NUMBER
, P_PERFIL  IN VARCHAR2
) RETURN VARCHAR2 AS
AGRUP VARCHAR(20);
BEGIN

 SELECT (CASE WHEN P_CODTIPOPER IN (1220,1224) THEN 'OUTRAS RECEITAS'
        WHEN P_CODTIPOPER IN (1510,1511, 1521,1930,2030,1971) AND P_CODCENCUS IN (101008, 0702002, 701001, 702007) THEN 'LICITACAO'
        WHEN P_CODTIPOPER NOT LIKE '15%' AND P_CODPROJ IN (10003032) AND P_CODTIPOPER IN (1900) THEN 'E-COMMERCE'
        WHEN P_CODTIPOPER NOT LIKE '15%' AND P_CODPROJ IN (10004165) AND P_CODTIPOPER IN (1203, 1202) THEN 'ASSINE-ONLINE'
        WHEN P_CODTIPOPER NOT LIKE '15%' AND P_CODPROJ IN (20001001) AND P_CODTIPOPER NOT IN   (1230, 1998) THEN 'AR POS PAGO'
        WHEN P_CODTIPOPER NOT LIKE '15%' AND P_PERFIL = 'PP' OR P_CODTIPOPER IN (1610) THEN 'ARs  PRE PAGA'
        WHEN P_CODTIPOPER NOT LIKE '15%' AND P_CODPROJ BETWEEN 20000000 AND 20009999 THEN 'AC'
        WHEN P_CODTIPOPER NOT LIKE '15%' AND P_CODPROJ BETWEEN 30000000 AND 30009999 THEN 'ESEC'
        WHEN P_CODTIPOPER NOT LIKE '15%' AND P_CODPROJ BETWEEN 40000000 AND 40009999 THEN 'COMPROVA'
        WHEN P_CODTIPOPER NOT LIKE '15%' AND P_CODPROJ = 10003029 THEN 'CORPORATIVO'
        WHEN P_CODTIPOPER NOT LIKE '15%' AND P_CODPROJ BETWEEN 60000000 AND 60009999 THEN 'MERCADOON'
     ELSE 'FILIAIS' END) AS AGRUP
     INTO AGRUP
FROM DUAL;

  RETURN AGRUP;
END FC_DASH_AGRUP_SOL;
